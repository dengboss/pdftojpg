# 文档批量转图片工具

一个功能强大的文档批量转图片转换工具，支持PDF、Word格式批量转换为JPEG、PNG图片格式。

## 功能特性

- 📄 **批量转换**: 支持同时处理多个文件和整个文件夹
- 🔄 **多格式支持**: 支持PDF、Word(.docx)格式
- 🖼️ **输出格式**: 支持JPEG、PNG格式输出
- 📊 **页数控制**: 可选择转换特定页数或全部页面
- 🎯 **清晰度选择**: 提供低、中、高三种清晰度选项
- 🎯 **拖拽支持**: 支持文件和文件夹拖拽到界面进行转换
- 📈 **实时进度**: 显示每个文件的转换进度
- 📋 **详细日志**: 记录每个文件的转换过程和结果
- 🗂️ **智能命名**: 自动为输出文件添加原文件名前缀，避免覆盖

## 安装说明

### 环境要求
- Python 3.7 或更高版本
- Windows 操作系统

### 安装步骤

1. **克隆或下载项目**
```bash
git clone [项目地址]
cd pdftojpg
```

2. **安装依赖**
```bash
pip install -r requirements.txt
```

3. **运行程序**
```bash
python document_converter.py
```

## 使用方法

### 批量文件操作

1. **添加文件**: 
   - 点击"添加文件"按钮选择多个文件
   - 点击"添加文件夹"按钮批量添加整个文件夹内的支持文件
   - 支持拖拽文件和文件夹到程序窗口
2. **管理文件列表**: 
   - 查看已添加的文件列表
   - 选择文件后点击"移除选中"删除不需要的文件
   - 点击"清空列表"移除所有文件
3. **选择输出目录**: 点击"选择目录"按钮，选择图片保存位置
4. **设置参数**: 
   - 选择输出图片格式(JPEG/PNG)
   - 设置要转换的页数(默认为1页)
   - 点击"全部"按钮可快速设置为全部页面
   - 选择清晰度：低(适合屏幕显示)、中(适合一般打印)、高(适合高质量印刷)
5. **开始批量转换**: 点击"开始转换"按钮批量处理所有文件

### 智能文件命名

- 输出文件自动添加原文件名前缀，避免文件覆盖
- 例如：`document1.docx` 转换为 `document1_page_1.jpg`, `document1_page_2.jpg`

### 拖拽操作

- 支持拖拽单个文件到窗口添加
- 支持拖拽多个文件同时添加
- 支持拖拽文件夹，自动递归添加所有支持的文档文件

### 进度查看

- 转换过程中会显示实时进度条
- 转换完成后会弹出提示框显示结果
- 详细日志会显示在下方的日志区域

## 技术实现

### 核心库
- **PyMuPDF**: 处理PDF文件转换
- **python-docx**: 处理Word文档
- **Pillow**: 图片处理和格式转换
- **PyQt5**: 图形用户界面

### 文件结构
```
pdftojpg/
├── document_converter.py    # 主程序文件
├── requirements.txt         # 依赖列表
└── README.md               # 使用说明
```

## 注意事项

1. **文件大小**: 大文件转换可能需要较长时间
2. **内存使用**: 处理大文件时建议使用较高内存配置
3. **输出格式**: JPEG格式适合照片类内容，PNG格式适合文本和图表
4. **Word限制**: Word转换目前仅支持.docx格式，旧版.doc格式需要转换为.docx后再使用

## 故障排除

### 常见问题

1. **缺少依赖**: 确保已安装所有requirements.txt中的依赖
2. **文件权限**: 确保有读取源文件和写入目标目录的权限
3. **格式不支持**: 检查文件是否为支持的格式(PDF/.docx)

### 错误信息

- "不支持的文件格式": 检查文件扩展名是否正确，旧版.doc格式需要转换为.docx
- "转换失败": 检查文件是否损坏或权限是否足够

## 更新日志

### v1.0.0
- ✨ 初始版本发布
- ✨ 支持PDF、Word(.docx)格式转换
- ✨ 支持JPEG、PNG输出格式
- ✨ 添加图形用户界面
- ✨ 支持拖拽操作和进度显示
- ✨ 页数选择默认1页，添加"全部"按钮